---
title: "IFLS_4_5 Cleaning"
author: "Chenoa Schatzki-McClain"
date: "April 7, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r clear environment}

rm(list=ls())

```

```{r}

#load data
IFLS_4_5 <- read.csv("C:/Users/cheno/Desktop/IFLS_all/DATA/R datasets/IFLS_4_5.csv")

#remove unneeded variables
vars <- c("marstat", "sex", "pidlink.x", "pidlink.x.x", "pidlink.x.x.x", "pidlink.y", "pidlink.y.y", "pidlink.y.y.y", "X", "X.1", "br03", "br04")

for (i in 1:length(vars)){
  IFLS_4_5[, vars[i]] <- NULL 
}

```

```{r emp vars W}

#add employment status variable

IFLS_4_5$employed <- c()

for (i in 1:nrow(IFLS_4_5)){
  
  IFLS_4_5[i, "employed"] <- ifelse(1 %in% as.numeric(IFLS_4_5[i,c("tk01", "tk01a", "tk03", "tk04")]), "1:Employed", "2:Unemployed")
  
}

IFLS_4_5$employed <- as.factor(IFLS_4_5$employed)

#add ever worked var based on employed and tk05

IFLS_4_5$ever_emp <- ifelse(IFLS_4_5$employed == "1:Employed"| IFLS_4_5$tk06a_H == 1, 1, IFLS_4_5$tk05)

IFLS_4_5$ever_emp <- as.factor(IFLS_4_5$ever_emp)


levels(IFLS_4_5$ever_emp) <- c("1:Yes", "2:No")

```

```{r emp vars H}

#add employment status variable

IFLS_4_5$employed_H <- c()

for (i in 1:nrow(IFLS_4_5)){
  
  IFLS_4_5[i, "employed_H"] <- ifelse(1 %in% as.numeric(IFLS_4_5[i,c("tk01_H", "tk01a_H", "tk03_H", "tk04_H")]), "1:Employed", "2:Unemployed")
  
}

IFLS_4_5$employed_H <- as.factor(IFLS_4_5$employed_H)

#add ever worked var based on employed, tk05, and tk06a

IFLS_4_5$ever_emp_H <- ifelse(IFLS_4_5$employed_H == "1:Employed" | IFLS_4_5$tk06a_H == 1, 1, IFLS_4_5$tk05_H)

IFLS_4_5$ever_emp_H <- as.factor(IFLS_4_5$ever_emp_H)


levels(IFLS_4_5$ever_emp_H) <- c("1:Yes", "2:No")


```

```{r}

#job loss in last 5 years

IFLS_4_5$job_loss <- ifelse(IFLS_4_5$ever_emp == "3:No" | IFLS_4_5$tk46a == "3:No", 2, IFLS_4_5$tk46b)

IFLS_4_5$job_loss_H <- ifelse(IFLS_4_5$ever_emp_H == "3:No" | IFLS_4_5$tk46a_H == "3:No", 2, IFLS_4_5$tk46b_H)

#multiple job losses



```

```{r hours}

#wage info available??

#lots of missing wage info, even for workers in private sector
length(IFLS_4_5[which((is.na(IFLS_4_5$tk25a1_H)) & as.numeric(IFLS_4_5$employed_H) == 1),1])
length(IFLS_4_5[which((is.na(IFLS_4_5$tk25a1_H)) & as.numeric(IFLS_4_5$tk24a) == 5),1])

#job type available >>> job type is available for almost all workers >> could serve as a proxy for wage
length(IFLS_4_5[which((is.na(IFLS_4_5$tk24a)) & as.numeric(IFLS_4_5$employed) == 1),1])
length(IFLS_4_5[which((is.na(IFLS_4_5$tk24a_H)) & as.numeric(IFLS_4_5$employed_H) == 1),1])




```
